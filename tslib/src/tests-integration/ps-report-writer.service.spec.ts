import { PsReportWriterService } from '../functions-ps-report/ps-report-4-writer/ps-report-writer.service'
import { PsychometricReport } from '../functions-ps-report/ps-report-4-writer/models'
import { IPsychometricReportLine } from '../functions-ps-report/ps-report-3-transformer/models'
import { SqlService } from '../sql/sql.service'
import { TYPES } from 'mssql'
import * as R from 'ramda'
import { MockPayload } from './mock-payload.class'
const ids = []

describe('ps report writer service integration test', () => {
  let sqlService: SqlService

  beforeAll(() => {
    sqlService = new SqlService()
  })

  async function getRow (pupilId: number): Promise<PsychometricReport | undefined> {
    const res: PsychometricReport[] = await sqlService.query('SELECT * FROM mtc_results.psychometricReport WHERE PupilId = @pupilId',
      [{ name: 'pupilId', value: pupilId, type: TYPES.Int }])
    return R.head(res)
  }

  async function cleanUp (): Promise<void> {
    const sql = 'DELETE FROM mtc_results.psychometricReport'
    await sqlService.modify(sql, [])
  }

  test('we can insert the payload', async () => {
    const payload: IPsychometricReportLine = new MockPayload()
    const reportWriter = new PsReportWriterService()
    await reportWriter.write(payload)
    ids.push(payload.PupilDatabaseId)
    const data = await getRow(payload.PupilDatabaseId)
    expect(data?.PupilId).toBe(payload.PupilDatabaseId)
    expect(data?.DOB?.format('YYYY-MM-DD')).toBe(payload.DOB?.format('YYYY-MM-DD'))
    expect(data?.Gender).toBe(payload.Gender)
    expect(data?.PupilUPN).toBe(payload.PupilUPN)
    expect(data?.Forename).toBe(payload.Forename)
    expect(data?.Surname).toBe(payload.Surname)
    expect(data?.FormMark).toBe(payload.FormMark)
    expect(data?.QDisplayTime).toBe(payload.QDisplayTime)
    expect(data?.PauseLength).toBe(payload.PauseLength)
    expect(data?.AccessArr).toBe(payload.AccessArr)
    expect(data?.RestartReason).toBe(payload.RestartReason)
    expect(data?.RestartNumber).toBe(payload.RestartNumber)
    expect(data?.ReasonNotTakingCheck).toBe(payload.ReasonNotTakingCheck)
    expect(data?.PupilStatus).toBe(payload.PupilStatus)
    expect(data?.DeviceId).toBe(payload.DeviceID)
    expect(data?.BrowserType).toBe(payload.BrowserType)
    expect(data?.SchoolName).toBe(payload.SchoolName)
    expect(data?.Estab).toBe(payload.Estab)
    expect(data?.SchoolURN).toBe(payload.SchoolURN)
    expect(data?.LANum).toBe(payload.LAnum)
    expect(data?.AttemptId).toBe(payload.AttemptID?.toUpperCase())
    expect(data?.FormID).toBe(payload.FormID)
    expect(data?.TestDate?.format('YYYY-MM-DD')).toBe(payload.TestDate?.format('YYYY-MM-DD'))
    expect(data?.TimeStart?.toISOString()).toBe(payload.TimeStart?.toISOString())
    expect(data?.TimeComplete?.toISOString()).toBe(payload.TimeComplete?.toISOString())
    expect(data?.TimeTaken).toBe(payload.TimeTaken)

    expect(data?.Q1ID).toBe(payload.answers[0].id)
    expect(data?.Q1Response).toBe(payload.answers[0].response)
    expect(data?.Q1InputMethods).toBe(payload.answers[0].inputMethods)
    expect(data?.Q1K).toBe(payload.answers[0].keystrokes)
    expect(data?.Q1Sco).toBe(payload.answers[0].score)
    expect(data?.Q1ResponseTime).toBe(payload.answers[0].responseTime)
    expect(data?.Q1TimeOut).toBe(Number(payload.answers[0].timeout))
    expect(data?.Q1TimeOutResponse).toBe(Number(payload.answers[0].timeoutResponse))
    expect(data?.Q1TimeOutSco).toBe(Number(payload.answers[0].timeoutScore))
    expect(data?.Q1tLoad?.toISOString()).toBe(payload.answers[0].loadTime?.toISOString())
    expect(data?.Q1tFirstKey?.toISOString()).toBe(payload.answers[0].firstKey?.toISOString())
    expect(data?.Q1tLastKey?.toISOString()).toBe(payload.answers[0].lastKey?.toISOString())
    expect(data?.Q1OverallTime).toBe(payload.answers[0].overallTime)
    expect(data?.Q1RecallTime).toBe(payload.answers[0].recallTime)
    expect(data?.Q1ReaderStart?.toISOString()).toBe(payload.answers[0].questionReaderStart?.toISOString())
    expect(data?.Q1ReaderEnd?.toISOString()).toBe(payload.answers[0].questionReaderEnd?.toISOString())

    expect(data?.Q2ID).toBe(payload.answers[1].id)
    expect(data?.Q2Response).toBe(payload.answers[1].response)
    expect(data?.Q2InputMethods).toBe(payload.answers[1].inputMethods)
    expect(data?.Q2K).toBe(payload.answers[1].keystrokes)
    expect(data?.Q2Sco).toBe(payload.answers[1].score)
    expect(data?.Q2ResponseTime).toBe(payload.answers[1].responseTime)
    expect(data?.Q2TimeOut).toBe(Number(payload.answers[1].timeout))
    expect(data?.Q2TimeOutResponse).toBe(Number(payload.answers[1].timeoutResponse))
    expect(data?.Q2TimeOutSco).toBe(Number(payload.answers[1].timeoutScore))
    expect(data?.Q2tLoad?.toISOString()).toBe(payload.answers[1].loadTime?.toISOString())
    expect(data?.Q2tFirstKey?.toISOString()).toBe(payload.answers[1].firstKey?.toISOString())
    expect(data?.Q2tLastKey?.toISOString()).toBe(payload.answers[1].lastKey?.toISOString())
    expect(data?.Q2OverallTime).toBe(payload.answers[1].overallTime)
    expect(data?.Q2RecallTime).toBe(payload.answers[1].recallTime)
    expect(data?.Q2ReaderStart?.toISOString()).toBe(payload.answers[1].questionReaderStart?.toISOString())
    expect(data?.Q2ReaderEnd?.toISOString()).toBe(payload.answers[1].questionReaderEnd?.toISOString())

    expect(data?.Q3ID).toBe(payload.answers[2].id)
    expect(data?.Q3Response).toBe(payload.answers[2].response)
    expect(data?.Q3InputMethods).toBe(payload.answers[2].inputMethods)
    expect(data?.Q3K).toBe(payload.answers[2].keystrokes)
    expect(data?.Q3Sco).toBe(payload.answers[2].score)
    expect(data?.Q3ResponseTime).toBe(payload.answers[2].responseTime)
    expect(data?.Q3TimeOut).toBe(Number(payload.answers[2].timeout))
    expect(data?.Q3TimeOutResponse).toBe(Number(payload.answers[2].timeoutResponse))
    expect(data?.Q3TimeOutSco).toBe(Number(payload.answers[2].timeoutScore))
    expect(data?.Q3tLoad?.toISOString()).toBe(payload.answers[2].loadTime?.toISOString())
    expect(data?.Q3tFirstKey?.toISOString()).toBe(payload.answers[2].firstKey?.toISOString())
    expect(data?.Q3tLastKey?.toISOString()).toBe(payload.answers[2].lastKey?.toISOString())
    expect(data?.Q3OverallTime).toBe(payload.answers[2].overallTime)
    expect(data?.Q3RecallTime).toBe(payload.answers[2].recallTime)
    expect(data?.Q3ReaderStart?.toISOString()).toBe(payload.answers[2].questionReaderStart?.toISOString())
    expect(data?.Q3ReaderEnd?.toISOString()).toBe(payload.answers[2].questionReaderEnd?.toISOString())

    expect(data?.Q4ID).toBe(payload.answers[3].id)
    expect(data?.Q4Response).toBe(payload.answers[3].response)
    expect(data?.Q4InputMethods).toBe(payload.answers[3].inputMethods)
    expect(data?.Q4K).toBe(payload.answers[3].keystrokes)
    expect(data?.Q4Sco).toBe(payload.answers[3].score)
    expect(data?.Q4ResponseTime).toBe(payload.answers[3].responseTime)
    expect(data?.Q4TimeOut).toBe(Number(payload.answers[3].timeout))
    expect(data?.Q4TimeOutResponse).toBe(Number(payload.answers[3].timeoutResponse))
    expect(data?.Q4TimeOutSco).toBe(Number(payload.answers[3].timeoutScore))
    expect(data?.Q4tLoad?.toISOString()).toBe(payload.answers[3].loadTime?.toISOString())
    expect(data?.Q4tFirstKey?.toISOString()).toBe(payload.answers[3].firstKey?.toISOString())
    expect(data?.Q4tLastKey?.toISOString()).toBe(payload.answers[3].lastKey?.toISOString())
    expect(data?.Q4OverallTime).toBe(payload.answers[3].overallTime)
    expect(data?.Q4RecallTime).toBe(payload.answers[3].recallTime)
    expect(data?.Q4ReaderStart?.toISOString()).toBe(payload.answers[3].questionReaderStart?.toISOString())
    expect(data?.Q4ReaderEnd?.toISOString()).toBe(payload.answers[3].questionReaderEnd?.toISOString())

    expect(data?.Q5ID).toBe(payload.answers[4].id)
    expect(data?.Q5Response).toBe(payload.answers[4].response)
    expect(data?.Q5InputMethods).toBe(payload.answers[4].inputMethods)
    expect(data?.Q5K).toBe(payload.answers[4].keystrokes)
    expect(data?.Q5Sco).toBe(payload.answers[4].score)
    expect(data?.Q5ResponseTime).toBe(payload.answers[4].responseTime)
    expect(data?.Q5TimeOut).toBe(Number(payload.answers[4].timeout))
    expect(data?.Q5TimeOutResponse).toBe(Number(payload.answers[4].timeoutResponse))
    expect(data?.Q5TimeOutSco).toBe(Number(payload.answers[4].timeoutScore))
    expect(data?.Q5tLoad?.toISOString()).toBe(payload.answers[4].loadTime?.toISOString())
    expect(data?.Q5tFirstKey?.toISOString()).toBe(payload.answers[4].firstKey?.toISOString())
    expect(data?.Q5tLastKey?.toISOString()).toBe(payload.answers[4].lastKey?.toISOString())
    expect(data?.Q5OverallTime).toBe(payload.answers[4].overallTime)
    expect(data?.Q5RecallTime).toBe(payload.answers[4].recallTime)
    expect(data?.Q5ReaderStart?.toISOString()).toBe(payload.answers[4].questionReaderStart?.toISOString())
    expect(data?.Q5ReaderEnd?.toISOString()).toBe(payload.answers[4].questionReaderEnd?.toISOString())

    expect(data?.Q6ID).toBe(payload.answers[5].id)
    expect(data?.Q6Response).toBe(payload.answers[5].response)
    expect(data?.Q6InputMethods).toBe(payload.answers[5].inputMethods)
    expect(data?.Q6K).toBe(payload.answers[5].keystrokes)
    expect(data?.Q6Sco).toBe(payload.answers[5].score)
    expect(data?.Q6ResponseTime).toBe(payload.answers[5].responseTime)
    expect(data?.Q6TimeOut).toBe(Number(payload.answers[5].timeout))
    expect(data?.Q6TimeOutResponse).toBe(Number(payload.answers[5].timeoutResponse))
    expect(data?.Q6TimeOutSco).toBe(Number(payload.answers[5].timeoutScore))
    expect(data?.Q6tLoad?.toISOString()).toBe(payload.answers[5].loadTime?.toISOString())
    expect(data?.Q6tFirstKey?.toISOString()).toBe(payload.answers[5].firstKey?.toISOString())
    expect(data?.Q6tLastKey?.toISOString()).toBe(payload.answers[5].lastKey?.toISOString())
    expect(data?.Q6OverallTime).toBe(payload.answers[5].overallTime)
    expect(data?.Q6RecallTime).toBe(payload.answers[5].recallTime)
    expect(data?.Q6ReaderStart?.toISOString()).toBe(payload.answers[5].questionReaderStart?.toISOString())
    expect(data?.Q6ReaderEnd?.toISOString()).toBe(payload.answers[5].questionReaderEnd?.toISOString())

    expect(data?.Q7ID).toBe(payload.answers[6].id)
    expect(data?.Q7Response).toBe(payload.answers[6].response)
    expect(data?.Q7InputMethods).toBe(payload.answers[6].inputMethods)
    expect(data?.Q7K).toBe(payload.answers[6].keystrokes)
    expect(data?.Q7Sco).toBe(payload.answers[6].score)
    expect(data?.Q7ResponseTime).toBe(payload.answers[6].responseTime)
    expect(data?.Q7TimeOut).toBe(Number(payload.answers[6].timeout))
    expect(data?.Q7TimeOutResponse).toBe(Number(payload.answers[6].timeoutResponse))
    expect(data?.Q7TimeOutSco).toBe(Number(payload.answers[6].timeoutScore))
    expect(data?.Q7tLoad?.toISOString()).toBe(payload.answers[6].loadTime?.toISOString())
    expect(data?.Q7tFirstKey?.toISOString()).toBe(payload.answers[6].firstKey?.toISOString())
    expect(data?.Q7tLastKey?.toISOString()).toBe(payload.answers[6].lastKey?.toISOString())
    expect(data?.Q7OverallTime).toBe(payload.answers[6].overallTime)
    expect(data?.Q7RecallTime).toBe(payload.answers[6].recallTime)
    expect(data?.Q7ReaderStart?.toISOString()).toBe(payload.answers[6].questionReaderStart?.toISOString())
    expect(data?.Q7ReaderEnd?.toISOString()).toBe(payload.answers[6].questionReaderEnd?.toISOString())

    expect(data?.Q8ID).toBe(payload.answers[7].id)
    expect(data?.Q8Response).toBe(payload.answers[7].response)
    expect(data?.Q8InputMethods).toBe(payload.answers[7].inputMethods)
    expect(data?.Q8K).toBe(payload.answers[7].keystrokes)
    expect(data?.Q8Sco).toBe(payload.answers[7].score)
    expect(data?.Q8ResponseTime).toBe(payload.answers[7].responseTime)
    expect(data?.Q8TimeOut).toBe(Number(payload.answers[7].timeout))
    expect(data?.Q8TimeOutResponse).toBe(Number(payload.answers[7].timeoutResponse))
    expect(data?.Q8TimeOutSco).toBe(Number(payload.answers[7].timeoutScore))
    expect(data?.Q8tLoad?.toISOString()).toBe(payload.answers[7].loadTime?.toISOString())
    expect(data?.Q8tFirstKey?.toISOString()).toBe(payload.answers[7].firstKey?.toISOString())
    expect(data?.Q8tLastKey?.toISOString()).toBe(payload.answers[7].lastKey?.toISOString())
    expect(data?.Q8OverallTime).toBe(payload.answers[7].overallTime)
    expect(data?.Q8RecallTime).toBe(payload.answers[7].recallTime)
    expect(data?.Q8ReaderStart?.toISOString()).toBe(payload.answers[7].questionReaderStart?.toISOString())
    expect(data?.Q8ReaderEnd?.toISOString()).toBe(payload.answers[7].questionReaderEnd?.toISOString())

    expect(data?.Q9ID).toBe(payload.answers[8].id)
    expect(data?.Q9Response).toBe(payload.answers[8].response)
    expect(data?.Q9InputMethods).toBe(payload.answers[8].inputMethods)
    expect(data?.Q9K).toBe(payload.answers[8].keystrokes)
    expect(data?.Q9Sco).toBe(payload.answers[8].score)
    expect(data?.Q9ResponseTime).toBe(payload.answers[8].responseTime)
    expect(data?.Q9TimeOut).toBe(Number(payload.answers[8].timeout))
    expect(data?.Q9TimeOutResponse).toBe(Number(payload.answers[8].timeoutResponse))
    expect(data?.Q9TimeOutSco).toBe(Number(payload.answers[8].timeoutScore))
    expect(data?.Q9tLoad?.toISOString()).toBe(payload.answers[8].loadTime?.toISOString())
    expect(data?.Q9tFirstKey?.toISOString()).toBe(payload.answers[8].firstKey?.toISOString())
    expect(data?.Q9tLastKey?.toISOString()).toBe(payload.answers[8].lastKey?.toISOString())
    expect(data?.Q9OverallTime).toBe(payload.answers[8].overallTime)
    expect(data?.Q9RecallTime).toBe(payload.answers[8].recallTime)
    expect(data?.Q9ReaderStart?.toISOString()).toBe(payload.answers[8].questionReaderStart?.toISOString())
    expect(data?.Q9ReaderEnd?.toISOString()).toBe(payload.answers[8].questionReaderEnd?.toISOString())

    expect(data?.Q10ID).toBe(payload.answers[9].id)
    expect(data?.Q10Response).toBe(payload.answers[9].response)
    expect(data?.Q10InputMethods).toBe(payload.answers[9].inputMethods)
    expect(data?.Q10K).toBe(payload.answers[9].keystrokes)
    expect(data?.Q10Sco).toBe(payload.answers[9].score)
    expect(data?.Q10ResponseTime).toBe(payload.answers[9].responseTime)
    expect(data?.Q10TimeOut).toBe(Number(payload.answers[9].timeout))
    expect(data?.Q10TimeOutResponse).toBe(Number(payload.answers[9].timeoutResponse))
    expect(data?.Q10TimeOutSco).toBe(Number(payload.answers[9].timeoutScore))
    expect(data?.Q10tLoad?.toISOString()).toBe(payload.answers[9].loadTime?.toISOString())
    expect(data?.Q10tFirstKey?.toISOString()).toBe(payload.answers[9].firstKey?.toISOString())
    expect(data?.Q10tLastKey?.toISOString()).toBe(payload.answers[9].lastKey?.toISOString())
    expect(data?.Q10OverallTime).toBe(payload.answers[9].overallTime)
    expect(data?.Q10RecallTime).toBe(payload.answers[9].recallTime)
    expect(data?.Q10ReaderStart?.toISOString()).toBe(payload.answers[9].questionReaderStart?.toISOString())
    expect(data?.Q10ReaderEnd?.toISOString()).toBe(payload.answers[9].questionReaderEnd?.toISOString())

    expect(data?.Q11ID).toBe(payload.answers[10].id)
    expect(data?.Q11Response).toBe(payload.answers[10].response)
    expect(data?.Q11InputMethods).toBe(payload.answers[10].inputMethods)
    expect(data?.Q11K).toBe(payload.answers[10].keystrokes)
    expect(data?.Q11Sco).toBe(payload.answers[10].score)
    expect(data?.Q11ResponseTime).toBe(payload.answers[10].responseTime)
    expect(data?.Q11TimeOut).toBe(Number(payload.answers[10].timeout))
    expect(data?.Q11TimeOutResponse).toBe(Number(payload.answers[10].timeoutResponse))
    expect(data?.Q11TimeOutSco).toBe(Number(payload.answers[10].timeoutScore))
    expect(data?.Q11tLoad?.toISOString()).toBe(payload.answers[10].loadTime?.toISOString())
    expect(data?.Q11tFirstKey?.toISOString()).toBe(payload.answers[10].firstKey?.toISOString())
    expect(data?.Q11tLastKey?.toISOString()).toBe(payload.answers[10].lastKey?.toISOString())
    expect(data?.Q11OverallTime).toBe(payload.answers[10].overallTime)
    expect(data?.Q11RecallTime).toBe(payload.answers[10].recallTime)
    expect(data?.Q11ReaderStart?.toISOString()).toBe(payload.answers[10].questionReaderStart?.toISOString())
    expect(data?.Q11ReaderEnd?.toISOString()).toBe(payload.answers[10].questionReaderEnd?.toISOString())

    expect(data?.Q12ID).toBe(payload.answers[11].id)
    expect(data?.Q12Response).toBe(payload.answers[11].response)
    expect(data?.Q12InputMethods).toBe(payload.answers[11].inputMethods)
    expect(data?.Q12K).toBe(payload.answers[11].keystrokes)
    expect(data?.Q12Sco).toBe(payload.answers[11].score)
    expect(data?.Q12ResponseTime).toBe(payload.answers[11].responseTime)
    expect(data?.Q12TimeOut).toBe(Number(payload.answers[11].timeout))
    expect(data?.Q12TimeOutResponse).toBe(Number(payload.answers[11].timeoutResponse))
    expect(data?.Q12TimeOutSco).toBe(Number(payload.answers[11].timeoutScore))
    expect(data?.Q12tLoad?.toISOString()).toBe(payload.answers[11].loadTime?.toISOString())
    expect(data?.Q12tFirstKey?.toISOString()).toBe(payload.answers[11].firstKey?.toISOString())
    expect(data?.Q12tLastKey?.toISOString()).toBe(payload.answers[11].lastKey?.toISOString())
    expect(data?.Q12OverallTime).toBe(payload.answers[11].overallTime)
    expect(data?.Q12RecallTime).toBe(payload.answers[11].recallTime)
    expect(data?.Q12ReaderStart?.toISOString()).toBe(payload.answers[11].questionReaderStart?.toISOString())
    expect(data?.Q12ReaderEnd?.toISOString()).toBe(payload.answers[11].questionReaderEnd?.toISOString())

    expect(data?.Q13ID).toBe(payload.answers[12].id)
    expect(data?.Q13Response).toBe(payload.answers[12].response)
    expect(data?.Q13InputMethods).toBe(payload.answers[12].inputMethods)
    expect(data?.Q13K).toBe(payload.answers[12].keystrokes)
    expect(data?.Q13Sco).toBe(payload.answers[12].score)
    expect(data?.Q13ResponseTime).toBe(payload.answers[12].responseTime)
    expect(data?.Q13TimeOut).toBe(Number(payload.answers[12].timeout))
    expect(data?.Q13TimeOutResponse).toBe(Number(payload.answers[12].timeoutResponse))
    expect(data?.Q13TimeOutSco).toBe(Number(payload.answers[12].timeoutScore))
    expect(data?.Q13tLoad?.toISOString()).toBe(payload.answers[12].loadTime?.toISOString())
    expect(data?.Q13tFirstKey?.toISOString()).toBe(payload.answers[12].firstKey?.toISOString())
    expect(data?.Q13tLastKey?.toISOString()).toBe(payload.answers[12].lastKey?.toISOString())
    expect(data?.Q13OverallTime).toBe(payload.answers[12].overallTime)
    expect(data?.Q13RecallTime).toBe(payload.answers[12].recallTime)
    expect(data?.Q13ReaderStart?.toISOString()).toBe(payload.answers[12].questionReaderStart?.toISOString())
    expect(data?.Q13ReaderEnd?.toISOString()).toBe(payload.answers[12].questionReaderEnd?.toISOString())

    expect(data?.Q14ID).toBe(payload.answers[13].id)
    expect(data?.Q14Response).toBe(payload.answers[13].response)
    expect(data?.Q14InputMethods).toBe(payload.answers[13].inputMethods)
    expect(data?.Q14K).toBe(payload.answers[13].keystrokes)
    expect(data?.Q14Sco).toBe(payload.answers[13].score)
    expect(data?.Q14ResponseTime).toBe(payload.answers[13].responseTime)
    expect(data?.Q14TimeOut).toBe(Number(payload.answers[13].timeout))
    expect(data?.Q14TimeOutResponse).toBe(Number(payload.answers[13].timeoutResponse))
    expect(data?.Q14TimeOutSco).toBe(Number(payload.answers[13].timeoutScore))
    expect(data?.Q14tLoad?.toISOString()).toBe(payload.answers[13].loadTime?.toISOString())
    expect(data?.Q14tFirstKey?.toISOString()).toBe(payload.answers[13].firstKey?.toISOString())
    expect(data?.Q14tLastKey?.toISOString()).toBe(payload.answers[13].lastKey?.toISOString())
    expect(data?.Q14OverallTime).toBe(payload.answers[13].overallTime)
    expect(data?.Q14RecallTime).toBe(payload.answers[13].recallTime)
    expect(data?.Q14ReaderStart?.toISOString()).toBe(payload.answers[13].questionReaderStart?.toISOString())
    expect(data?.Q14ReaderEnd?.toISOString()).toBe(payload.answers[13].questionReaderEnd?.toISOString())

    expect(data?.Q15ID).toBe(payload.answers[14].id)
    expect(data?.Q15Response).toBe(payload.answers[14].response)
    expect(data?.Q15InputMethods).toBe(payload.answers[14].inputMethods)
    expect(data?.Q15K).toBe(payload.answers[14].keystrokes)
    expect(data?.Q15Sco).toBe(payload.answers[14].score)
    expect(data?.Q15ResponseTime).toBe(payload.answers[14].responseTime)
    expect(data?.Q15TimeOut).toBe(Number(payload.answers[14].timeout))
    expect(data?.Q15TimeOutResponse).toBe(Number(payload.answers[14].timeoutResponse))
    expect(data?.Q15TimeOutSco).toBe(Number(payload.answers[14].timeoutScore))
    expect(data?.Q15tLoad?.toISOString()).toBe(payload.answers[14].loadTime?.toISOString())
    expect(data?.Q15tFirstKey?.toISOString()).toBe(payload.answers[14].firstKey?.toISOString())
    expect(data?.Q15tLastKey?.toISOString()).toBe(payload.answers[14].lastKey?.toISOString())
    expect(data?.Q15OverallTime).toBe(payload.answers[14].overallTime)
    expect(data?.Q15RecallTime).toBe(payload.answers[14].recallTime)
    expect(data?.Q15ReaderStart?.toISOString()).toBe(payload.answers[14].questionReaderStart?.toISOString())
    expect(data?.Q15ReaderEnd?.toISOString()).toBe(payload.answers[14].questionReaderEnd?.toISOString())

    expect(data?.Q16ID).toBe(payload.answers[15].id)
    expect(data?.Q16Response).toBe(payload.answers[15].response)
    expect(data?.Q16InputMethods).toBe(payload.answers[15].inputMethods)
    expect(data?.Q16K).toBe(payload.answers[15].keystrokes)
    expect(data?.Q16Sco).toBe(payload.answers[15].score)
    expect(data?.Q16ResponseTime).toBe(payload.answers[15].responseTime)
    expect(data?.Q16TimeOut).toBe(Number(payload.answers[15].timeout))
    expect(data?.Q16TimeOutResponse).toBe(Number(payload.answers[15].timeoutResponse))
    expect(data?.Q16TimeOutSco).toBe(Number(payload.answers[15].timeoutScore))
    expect(data?.Q16tLoad?.toISOString()).toBe(payload.answers[15].loadTime?.toISOString())
    expect(data?.Q16tFirstKey?.toISOString()).toBe(payload.answers[15].firstKey?.toISOString())
    expect(data?.Q16tLastKey?.toISOString()).toBe(payload.answers[15].lastKey?.toISOString())
    expect(data?.Q16OverallTime).toBe(payload.answers[15].overallTime)
    expect(data?.Q16RecallTime).toBe(payload.answers[15].recallTime)
    expect(data?.Q16ReaderStart?.toISOString()).toBe(payload.answers[15].questionReaderStart?.toISOString())
    expect(data?.Q16ReaderEnd?.toISOString()).toBe(payload.answers[15].questionReaderEnd?.toISOString())

    expect(data?.Q17ID).toBe(payload.answers[16].id)
    expect(data?.Q17Response).toBe(payload.answers[16].response)
    expect(data?.Q17InputMethods).toBe(payload.answers[16].inputMethods)
    expect(data?.Q17K).toBe(payload.answers[16].keystrokes)
    expect(data?.Q17Sco).toBe(payload.answers[16].score)
    expect(data?.Q17ResponseTime).toBe(payload.answers[16].responseTime)
    expect(data?.Q17TimeOut).toBe(Number(payload.answers[16].timeout))
    expect(data?.Q17TimeOutResponse).toBe(Number(payload.answers[16].timeoutResponse))
    expect(data?.Q17TimeOutSco).toBe(Number(payload.answers[16].timeoutScore))
    expect(data?.Q17tLoad?.toISOString()).toBe(payload.answers[16].loadTime?.toISOString())
    expect(data?.Q17tFirstKey?.toISOString()).toBe(payload.answers[16].firstKey?.toISOString())
    expect(data?.Q17tLastKey?.toISOString()).toBe(payload.answers[16].lastKey?.toISOString())
    expect(data?.Q17OverallTime).toBe(payload.answers[16].overallTime)
    expect(data?.Q17RecallTime).toBe(payload.answers[16].recallTime)
    expect(data?.Q17ReaderStart?.toISOString()).toBe(payload.answers[16].questionReaderStart?.toISOString())
    expect(data?.Q17ReaderEnd?.toISOString()).toBe(payload.answers[16].questionReaderEnd?.toISOString())

    expect(data?.Q18ID).toBe(payload.answers[17].id)
    expect(data?.Q18Response).toBe(payload.answers[17].response)
    expect(data?.Q18InputMethods).toBe(payload.answers[17].inputMethods)
    expect(data?.Q18K).toBe(payload.answers[17].keystrokes)
    expect(data?.Q18Sco).toBe(payload.answers[17].score)
    expect(data?.Q18ResponseTime).toBe(payload.answers[17].responseTime)
    expect(data?.Q18TimeOut).toBe(Number(payload.answers[17].timeout))
    expect(data?.Q18TimeOutResponse).toBe(Number(payload.answers[17].timeoutResponse))
    expect(data?.Q18TimeOutSco).toBe(Number(payload.answers[17].timeoutScore))
    expect(data?.Q18tLoad?.toISOString()).toBe(payload.answers[17].loadTime?.toISOString())
    expect(data?.Q18tFirstKey?.toISOString()).toBe(payload.answers[17].firstKey?.toISOString())
    expect(data?.Q18tLastKey?.toISOString()).toBe(payload.answers[17].lastKey?.toISOString())
    expect(data?.Q18OverallTime).toBe(payload.answers[17].overallTime)
    expect(data?.Q18RecallTime).toBe(payload.answers[17].recallTime)
    expect(data?.Q18ReaderStart?.toISOString()).toBe(payload.answers[17].questionReaderStart?.toISOString())
    expect(data?.Q18ReaderEnd?.toISOString()).toBe(payload.answers[17].questionReaderEnd?.toISOString())

    expect(data?.Q19ID).toBe(payload.answers[18].id)
    expect(data?.Q19Response).toBe(payload.answers[18].response)
    expect(data?.Q19InputMethods).toBe(payload.answers[18].inputMethods)
    expect(data?.Q19K).toBe(payload.answers[18].keystrokes)
    expect(data?.Q19Sco).toBe(payload.answers[18].score)
    expect(data?.Q19ResponseTime).toBe(payload.answers[18].responseTime)
    expect(data?.Q19TimeOut).toBe(Number(payload.answers[18].timeout))
    expect(data?.Q19TimeOutResponse).toBe(Number(payload.answers[18].timeoutResponse))
    expect(data?.Q19TimeOutSco).toBe(Number(payload.answers[18].timeoutScore))
    expect(data?.Q19tLoad?.toISOString()).toBe(payload.answers[18].loadTime?.toISOString())
    expect(data?.Q19tFirstKey?.toISOString()).toBe(payload.answers[18].firstKey?.toISOString())
    expect(data?.Q19tLastKey?.toISOString()).toBe(payload.answers[18].lastKey?.toISOString())
    expect(data?.Q19OverallTime).toBe(payload.answers[18].overallTime)
    expect(data?.Q19RecallTime).toBe(payload.answers[18].recallTime)
    expect(data?.Q19ReaderStart?.toISOString()).toBe(payload.answers[18].questionReaderStart?.toISOString())
    expect(data?.Q19ReaderEnd?.toISOString()).toBe(payload.answers[18].questionReaderEnd?.toISOString())

    expect(data?.Q20ID).toBe(payload.answers[19].id)
    expect(data?.Q20Response).toBe(payload.answers[19].response)
    expect(data?.Q20InputMethods).toBe(payload.answers[19].inputMethods)
    expect(data?.Q20K).toBe(payload.answers[19].keystrokes)
    expect(data?.Q20Sco).toBe(payload.answers[19].score)
    expect(data?.Q20ResponseTime).toBe(payload.answers[19].responseTime)
    expect(data?.Q20TimeOut).toBe(Number(payload.answers[19].timeout))
    expect(data?.Q20TimeOutResponse).toBe(Number(payload.answers[19].timeoutResponse))
    expect(data?.Q20TimeOutSco).toBe(Number(payload.answers[19].timeoutScore))
    expect(data?.Q20tLoad?.toISOString()).toBe(payload.answers[19].loadTime?.toISOString())
    expect(data?.Q20tFirstKey?.toISOString()).toBe(payload.answers[19].firstKey?.toISOString())
    expect(data?.Q20tLastKey?.toISOString()).toBe(payload.answers[19].lastKey?.toISOString())
    expect(data?.Q20OverallTime).toBe(payload.answers[19].overallTime)
    expect(data?.Q20RecallTime).toBe(payload.answers[19].recallTime)
    expect(data?.Q20ReaderStart?.toISOString()).toBe(payload.answers[19].questionReaderStart?.toISOString())
    expect(data?.Q20ReaderEnd?.toISOString()).toBe(payload.answers[19].questionReaderEnd?.toISOString())

    expect(data?.Q21ID).toBe(payload.answers[20].id)
    expect(data?.Q21Response).toBe(payload.answers[20].response)
    expect(data?.Q21InputMethods).toBe(payload.answers[20].inputMethods)
    expect(data?.Q21K).toBe(payload.answers[20].keystrokes)
    expect(data?.Q21Sco).toBe(payload.answers[20].score)
    expect(data?.Q21ResponseTime).toBe(payload.answers[20].responseTime)
    expect(data?.Q21TimeOut).toBe(Number(payload.answers[20].timeout))
    expect(data?.Q21TimeOutResponse).toBe(Number(payload.answers[20].timeoutResponse))
    expect(data?.Q21TimeOutSco).toBe(Number(payload.answers[20].timeoutScore))
    expect(data?.Q21tLoad?.toISOString()).toBe(payload.answers[20].loadTime?.toISOString())
    expect(data?.Q21tFirstKey?.toISOString()).toBe(payload.answers[20].firstKey?.toISOString())
    expect(data?.Q21tLastKey?.toISOString()).toBe(payload.answers[20].lastKey?.toISOString())
    expect(data?.Q21OverallTime).toBe(payload.answers[20].overallTime)
    expect(data?.Q21RecallTime).toBe(payload.answers[20].recallTime)
    expect(data?.Q21ReaderStart?.toISOString()).toBe(payload.answers[20].questionReaderStart?.toISOString())
    expect(data?.Q21ReaderEnd?.toISOString()).toBe(payload.answers[20].questionReaderEnd?.toISOString())

    expect(data?.Q22ID).toBe(payload.answers[21].id)
    expect(data?.Q22Response).toBe(payload.answers[21].response)
    expect(data?.Q22InputMethods).toBe(payload.answers[21].inputMethods)
    expect(data?.Q22K).toBe(payload.answers[21].keystrokes)
    expect(data?.Q22Sco).toBe(payload.answers[21].score)
    expect(data?.Q22ResponseTime).toBe(payload.answers[21].responseTime)
    expect(data?.Q22TimeOut).toBe(Number(payload.answers[21].timeout))
    expect(data?.Q22TimeOutResponse).toBe(Number(payload.answers[21].timeoutResponse))
    expect(data?.Q22TimeOutSco).toBe(Number(payload.answers[21].timeoutScore))
    expect(data?.Q22tLoad?.toISOString()).toBe(payload.answers[21].loadTime?.toISOString())
    expect(data?.Q22tFirstKey?.toISOString()).toBe(payload.answers[21].firstKey?.toISOString())
    expect(data?.Q22tLastKey?.toISOString()).toBe(payload.answers[21].lastKey?.toISOString())
    expect(data?.Q22OverallTime).toBe(payload.answers[21].overallTime)
    expect(data?.Q22RecallTime).toBe(payload.answers[21].recallTime)
    expect(data?.Q22ReaderStart?.toISOString()).toBe(payload.answers[21].questionReaderStart?.toISOString())
    expect(data?.Q22ReaderEnd?.toISOString()).toBe(payload.answers[21].questionReaderEnd?.toISOString())

    expect(data?.Q23ID).toBe(payload.answers[22].id)
    expect(data?.Q23Response).toBe(payload.answers[22].response)
    expect(data?.Q23InputMethods).toBe(payload.answers[22].inputMethods)
    expect(data?.Q23K).toBe(payload.answers[22].keystrokes)
    expect(data?.Q23Sco).toBe(payload.answers[22].score)
    expect(data?.Q23ResponseTime).toBe(payload.answers[22].responseTime)
    expect(data?.Q23TimeOut).toBe(Number(payload.answers[22].timeout))
    expect(data?.Q23TimeOutResponse).toBe(Number(payload.answers[22].timeoutResponse))
    expect(data?.Q23TimeOutSco).toBe(Number(payload.answers[22].timeoutScore))
    expect(data?.Q23tLoad?.toISOString()).toBe(payload.answers[22].loadTime?.toISOString())
    expect(data?.Q23tFirstKey?.toISOString()).toBe(payload.answers[22].firstKey?.toISOString())
    expect(data?.Q23tLastKey?.toISOString()).toBe(payload.answers[22].lastKey?.toISOString())
    expect(data?.Q23OverallTime).toBe(payload.answers[22].overallTime)
    expect(data?.Q23RecallTime).toBe(payload.answers[22].recallTime)
    expect(data?.Q23ReaderStart?.toISOString()).toBe(payload.answers[22].questionReaderStart?.toISOString())
    expect(data?.Q23ReaderEnd?.toISOString()).toBe(payload.answers[22].questionReaderEnd?.toISOString())

    expect(data?.Q24ID).toBe(payload.answers[23].id)
    expect(data?.Q24Response).toBe(payload.answers[23].response)
    expect(data?.Q24InputMethods).toBe(payload.answers[23].inputMethods)
    expect(data?.Q24K).toBe(payload.answers[23].keystrokes)
    expect(data?.Q24Sco).toBe(payload.answers[23].score)
    expect(data?.Q24ResponseTime).toBe(payload.answers[23].responseTime)
    expect(data?.Q24TimeOut).toBe(Number(payload.answers[23].timeout))
    expect(data?.Q24TimeOutResponse).toBe(Number(payload.answers[23].timeoutResponse))
    expect(data?.Q24TimeOutSco).toBe(Number(payload.answers[23].timeoutScore))
    expect(data?.Q24tLoad?.toISOString()).toBe(payload.answers[23].loadTime?.toISOString())
    expect(data?.Q24tFirstKey?.toISOString()).toBe(payload.answers[23].firstKey?.toISOString())
    expect(data?.Q24tLastKey?.toISOString()).toBe(payload.answers[23].lastKey?.toISOString())
    expect(data?.Q24OverallTime).toBe(payload.answers[23].overallTime)
    expect(data?.Q24RecallTime).toBe(payload.answers[23].recallTime)
    expect(data?.Q24ReaderStart?.toISOString()).toBe(payload.answers[23].questionReaderStart?.toISOString())
    expect(data?.Q24ReaderEnd?.toISOString()).toBe(payload.answers[23].questionReaderEnd?.toISOString())

    expect(data?.Q25ID).toBe(payload.answers[24].id)
    expect(data?.Q25Response).toBe(payload.answers[24].response)
    expect(data?.Q25InputMethods).toBe(payload.answers[24].inputMethods)
    expect(data?.Q25K).toBe(payload.answers[24].keystrokes)
    expect(data?.Q25Sco).toBe(payload.answers[24].score)
    expect(data?.Q25ResponseTime).toBe(payload.answers[24].responseTime)
    expect(data?.Q25TimeOut).toBe(Number(payload.answers[24].timeout))
    expect(data?.Q25TimeOutResponse).toBe(Number(payload.answers[24].timeoutResponse))
    expect(data?.Q25TimeOutSco).toBe(Number(payload.answers[24].timeoutScore))
    expect(data?.Q25tLoad?.toISOString()).toBe(payload.answers[24].loadTime?.toISOString())
    expect(data?.Q25tFirstKey?.toISOString()).toBe(payload.answers[24].firstKey?.toISOString())
    expect(data?.Q25tLastKey?.toISOString()).toBe(payload.answers[24].lastKey?.toISOString())
    expect(data?.Q25OverallTime).toBe(payload.answers[24].overallTime)
    expect(data?.Q25RecallTime).toBe(payload.answers[24].recallTime)
    expect(data?.Q25ReaderStart?.toISOString()).toBe(payload.answers[24].questionReaderStart?.toISOString())
    expect(data?.Q25ReaderEnd?.toISOString()).toBe(payload.answers[24].questionReaderEnd?.toISOString())
  })

  test('we can update the payload', async () => {
    const insertPayload: IPsychometricReportLine = new MockPayload()
    const reportWriter = new PsReportWriterService()
    await reportWriter.write(insertPayload) // insert
    ids.push(insertPayload.PupilDatabaseId)
    const payload = new MockPayload() // random values
    // New payload - this has new random values, so just copy the Primary Key over to the new payload
    payload.PupilDatabaseId = insertPayload.PupilDatabaseId
    await reportWriter.write(payload) // update
    const data = await getRow(payload.PupilDatabaseId)

    expect(data?.PupilId).toBe(payload.PupilDatabaseId)
    expect(data?.DOB?.format('YYYY-MM-DD')).toStrictEqual(payload.DOB?.format('YYYY-MM-DD'))
    expect(data?.Gender).toBe(payload.Gender)
    expect(data?.PupilUPN).toBe(payload.PupilUPN)
    expect(data?.Forename).toBe(payload.Forename)
    expect(data?.Surname).toBe(payload.Surname)
    expect(data?.FormMark).toBe(payload.FormMark)
    expect(data?.QDisplayTime).toBe(payload.QDisplayTime)
    expect(data?.PauseLength).toBe(payload.PauseLength)
    expect(data?.AccessArr).toBe(payload.AccessArr)
    expect(data?.RestartReason).toBe(payload.RestartReason)
    expect(data?.RestartNumber).toBe(payload.RestartNumber)
    expect(data?.ReasonNotTakingCheck).toBe(payload.ReasonNotTakingCheck)
    expect(data?.PupilStatus).toBe(payload.PupilStatus)
    expect(data?.DeviceId).toBe(payload.DeviceID)
    expect(data?.BrowserType).toBe(payload.BrowserType)
    expect(data?.SchoolName).toBe(payload.SchoolName)
    expect(data?.Estab).toBe(payload.Estab)
    expect(data?.SchoolURN).toBe(payload.SchoolURN)
    expect(data?.LANum).toBe(payload.LAnum)
    expect(data?.AttemptId).toBe(payload.AttemptID?.toUpperCase())
    expect(data?.FormID).toBe(payload.FormID)
    expect(data?.TestDate?.format('YYYY-MM-DD')).toBe(payload.TestDate?.format('YYYY-MM-DD'))
    expect(data?.TimeStart?.toISOString()).toBe(payload.TimeStart?.toISOString())
    expect(data?.TimeComplete?.toISOString()).toBe(payload.TimeComplete?.toISOString())
    expect(data?.TimeTaken).toBe(payload.TimeTaken)

    expect(data?.Q1ID).toBe(payload.answers[0].id)
    expect(data?.Q1Response).toBe(payload.answers[0].response)
    expect(data?.Q1InputMethods).toBe(payload.answers[0].inputMethods)
    expect(data?.Q1K).toBe(payload.answers[0].keystrokes)
    expect(data?.Q1Sco).toBe(payload.answers[0].score)
    expect(data?.Q1ResponseTime).toBe(payload.answers[0].responseTime)
    expect(data?.Q1TimeOut).toBe(Number(payload.answers[0].timeout))
    expect(data?.Q1TimeOutResponse).toBe(Number(payload.answers[0].timeoutResponse))
    expect(data?.Q1TimeOutSco).toBe(Number(payload.answers[0].timeoutScore))
    expect(data?.Q1tLoad?.toISOString()).toBe(payload.answers[0].loadTime?.toISOString())
    expect(data?.Q1tFirstKey?.toISOString()).toBe(payload.answers[0].firstKey?.toISOString())
    expect(data?.Q1tLastKey?.toISOString()).toBe(payload.answers[0].lastKey?.toISOString())
    expect(data?.Q1OverallTime).toBe(payload.answers[0].overallTime)
    expect(data?.Q1RecallTime).toBe(payload.answers[0].recallTime)
    expect(data?.Q1ReaderStart?.toISOString()).toBe(payload.answers[0].questionReaderStart?.toISOString())
    expect(data?.Q1ReaderEnd?.toISOString()).toBe(payload.answers[0].questionReaderEnd?.toISOString())

    expect(data?.Q2ID).toBe(payload.answers[1].id)
    expect(data?.Q2Response).toBe(payload.answers[1].response)
    expect(data?.Q2InputMethods).toBe(payload.answers[1].inputMethods)
    expect(data?.Q2K).toBe(payload.answers[1].keystrokes)
    expect(data?.Q2Sco).toBe(payload.answers[1].score)
    expect(data?.Q2ResponseTime).toBe(payload.answers[1].responseTime)
    expect(data?.Q2TimeOut).toBe(Number(payload.answers[1].timeout))
    expect(data?.Q2TimeOutResponse).toBe(Number(payload.answers[1].timeoutResponse))
    expect(data?.Q2TimeOutSco).toBe(Number(payload.answers[1].timeoutScore))
    expect(data?.Q2tLoad?.toISOString()).toBe(payload.answers[1].loadTime?.toISOString())
    expect(data?.Q2tFirstKey?.toISOString()).toBe(payload.answers[1].firstKey?.toISOString())
    expect(data?.Q2tLastKey?.toISOString()).toBe(payload.answers[1].lastKey?.toISOString())
    expect(data?.Q2OverallTime).toBe(payload.answers[1].overallTime)
    expect(data?.Q2RecallTime).toBe(payload.answers[1].recallTime)
    expect(data?.Q2ReaderStart?.toISOString()).toBe(payload.answers[1].questionReaderStart?.toISOString())
    expect(data?.Q2ReaderEnd?.toISOString()).toBe(payload.answers[1].questionReaderEnd?.toISOString())

    expect(data?.Q3ID).toBe(payload.answers[2].id)
    expect(data?.Q3Response).toBe(payload.answers[2].response)
    expect(data?.Q3InputMethods).toBe(payload.answers[2].inputMethods)
    expect(data?.Q3K).toBe(payload.answers[2].keystrokes)
    expect(data?.Q3Sco).toBe(payload.answers[2].score)
    expect(data?.Q3ResponseTime).toBe(payload.answers[2].responseTime)
    expect(data?.Q3TimeOut).toBe(Number(payload.answers[2].timeout))
    expect(data?.Q3TimeOutResponse).toBe(Number(payload.answers[2].timeoutResponse))
    expect(data?.Q3TimeOutSco).toBe(Number(payload.answers[2].timeoutScore))
    expect(data?.Q3tLoad?.toISOString()).toBe(payload.answers[2].loadTime?.toISOString())
    expect(data?.Q3tFirstKey?.toISOString()).toBe(payload.answers[2].firstKey?.toISOString())
    expect(data?.Q3tLastKey?.toISOString()).toBe(payload.answers[2].lastKey?.toISOString())
    expect(data?.Q3OverallTime).toBe(payload.answers[2].overallTime)
    expect(data?.Q3RecallTime).toBe(payload.answers[2].recallTime)
    expect(data?.Q3ReaderStart?.toISOString()).toBe(payload.answers[2].questionReaderStart?.toISOString())
    expect(data?.Q3ReaderEnd?.toISOString()).toBe(payload.answers[2].questionReaderEnd?.toISOString())

    expect(data?.Q4ID).toBe(payload.answers[3].id)
    expect(data?.Q4Response).toBe(payload.answers[3].response)
    expect(data?.Q4InputMethods).toBe(payload.answers[3].inputMethods)
    expect(data?.Q4K).toBe(payload.answers[3].keystrokes)
    expect(data?.Q4Sco).toBe(payload.answers[3].score)
    expect(data?.Q4ResponseTime).toBe(payload.answers[3].responseTime)
    expect(data?.Q4TimeOut).toBe(Number(payload.answers[3].timeout))
    expect(data?.Q4TimeOutResponse).toBe(Number(payload.answers[3].timeoutResponse))
    expect(data?.Q4TimeOutSco).toBe(Number(payload.answers[3].timeoutScore))
    expect(data?.Q4tLoad?.toISOString()).toBe(payload.answers[3].loadTime?.toISOString())
    expect(data?.Q4tFirstKey?.toISOString()).toBe(payload.answers[3].firstKey?.toISOString())
    expect(data?.Q4tLastKey?.toISOString()).toBe(payload.answers[3].lastKey?.toISOString())
    expect(data?.Q4OverallTime).toBe(payload.answers[3].overallTime)
    expect(data?.Q4RecallTime).toBe(payload.answers[3].recallTime)
    expect(data?.Q4ReaderStart?.toISOString()).toBe(payload.answers[3].questionReaderStart?.toISOString())
    expect(data?.Q4ReaderEnd?.toISOString()).toBe(payload.answers[3].questionReaderEnd?.toISOString())

    expect(data?.Q5ID).toBe(payload.answers[4].id)
    expect(data?.Q5Response).toBe(payload.answers[4].response)
    expect(data?.Q5InputMethods).toBe(payload.answers[4].inputMethods)
    expect(data?.Q5K).toBe(payload.answers[4].keystrokes)
    expect(data?.Q5Sco).toBe(payload.answers[4].score)
    expect(data?.Q5ResponseTime).toBe(payload.answers[4].responseTime)
    expect(data?.Q5TimeOut).toBe(Number(payload.answers[4].timeout))
    expect(data?.Q5TimeOutResponse).toBe(Number(payload.answers[4].timeoutResponse))
    expect(data?.Q5TimeOutSco).toBe(Number(payload.answers[4].timeoutScore))
    expect(data?.Q5tLoad?.toISOString()).toBe(payload.answers[4].loadTime?.toISOString())
    expect(data?.Q5tFirstKey?.toISOString()).toBe(payload.answers[4].firstKey?.toISOString())
    expect(data?.Q5tLastKey?.toISOString()).toBe(payload.answers[4].lastKey?.toISOString())
    expect(data?.Q5OverallTime).toBe(payload.answers[4].overallTime)
    expect(data?.Q5RecallTime).toBe(payload.answers[4].recallTime)
    expect(data?.Q5ReaderStart?.toISOString()).toBe(payload.answers[4].questionReaderStart?.toISOString())
    expect(data?.Q5ReaderEnd?.toISOString()).toBe(payload.answers[4].questionReaderEnd?.toISOString())

    expect(data?.Q6ID).toBe(payload.answers[5].id)
    expect(data?.Q6Response).toBe(payload.answers[5].response)
    expect(data?.Q6InputMethods).toBe(payload.answers[5].inputMethods)
    expect(data?.Q6K).toBe(payload.answers[5].keystrokes)
    expect(data?.Q6Sco).toBe(payload.answers[5].score)
    expect(data?.Q6ResponseTime).toBe(payload.answers[5].responseTime)
    expect(data?.Q6TimeOut).toBe(Number(payload.answers[5].timeout))
    expect(data?.Q6TimeOutResponse).toBe(Number(payload.answers[5].timeoutResponse))
    expect(data?.Q6TimeOutSco).toBe(Number(payload.answers[5].timeoutScore))
    expect(data?.Q6tLoad?.toISOString()).toBe(payload.answers[5].loadTime?.toISOString())
    expect(data?.Q6tFirstKey?.toISOString()).toBe(payload.answers[5].firstKey?.toISOString())
    expect(data?.Q6tLastKey?.toISOString()).toBe(payload.answers[5].lastKey?.toISOString())
    expect(data?.Q6OverallTime).toBe(payload.answers[5].overallTime)
    expect(data?.Q6RecallTime).toBe(payload.answers[5].recallTime)
    expect(data?.Q6ReaderStart?.toISOString()).toBe(payload.answers[5].questionReaderStart?.toISOString())
    expect(data?.Q6ReaderEnd?.toISOString()).toBe(payload.answers[5].questionReaderEnd?.toISOString())

    expect(data?.Q7ID).toBe(payload.answers[6].id)
    expect(data?.Q7Response).toBe(payload.answers[6].response)
    expect(data?.Q7InputMethods).toBe(payload.answers[6].inputMethods)
    expect(data?.Q7K).toBe(payload.answers[6].keystrokes)
    expect(data?.Q7Sco).toBe(payload.answers[6].score)
    expect(data?.Q7ResponseTime).toBe(payload.answers[6].responseTime)
    expect(data?.Q7TimeOut).toBe(Number(payload.answers[6].timeout))
    expect(data?.Q7TimeOutResponse).toBe(Number(payload.answers[6].timeoutResponse))
    expect(data?.Q7TimeOutSco).toBe(Number(payload.answers[6].timeoutScore))
    expect(data?.Q7tLoad?.toISOString()).toBe(payload.answers[6].loadTime?.toISOString())
    expect(data?.Q7tFirstKey?.toISOString()).toBe(payload.answers[6].firstKey?.toISOString())
    expect(data?.Q7tLastKey?.toISOString()).toBe(payload.answers[6].lastKey?.toISOString())
    expect(data?.Q7OverallTime).toBe(payload.answers[6].overallTime)
    expect(data?.Q7RecallTime).toBe(payload.answers[6].recallTime)
    expect(data?.Q7ReaderStart?.toISOString()).toBe(payload.answers[6].questionReaderStart?.toISOString())
    expect(data?.Q7ReaderEnd?.toISOString()).toBe(payload.answers[6].questionReaderEnd?.toISOString())

    expect(data?.Q8ID).toBe(payload.answers[7].id)
    expect(data?.Q8Response).toBe(payload.answers[7].response)
    expect(data?.Q8InputMethods).toBe(payload.answers[7].inputMethods)
    expect(data?.Q8K).toBe(payload.answers[7].keystrokes)
    expect(data?.Q8Sco).toBe(payload.answers[7].score)
    expect(data?.Q8ResponseTime).toBe(payload.answers[7].responseTime)
    expect(data?.Q8TimeOut).toBe(Number(payload.answers[7].timeout))
    expect(data?.Q8TimeOutResponse).toBe(Number(payload.answers[7].timeoutResponse))
    expect(data?.Q8TimeOutSco).toBe(Number(payload.answers[7].timeoutScore))
    expect(data?.Q8tLoad?.toISOString()).toBe(payload.answers[7].loadTime?.toISOString())
    expect(data?.Q8tFirstKey?.toISOString()).toBe(payload.answers[7].firstKey?.toISOString())
    expect(data?.Q8tLastKey?.toISOString()).toBe(payload.answers[7].lastKey?.toISOString())
    expect(data?.Q8OverallTime).toBe(payload.answers[7].overallTime)
    expect(data?.Q8RecallTime).toBe(payload.answers[7].recallTime)
    expect(data?.Q8ReaderStart?.toISOString()).toBe(payload.answers[7].questionReaderStart?.toISOString())
    expect(data?.Q8ReaderEnd?.toISOString()).toBe(payload.answers[7].questionReaderEnd?.toISOString())

    expect(data?.Q9ID).toBe(payload.answers[8].id)
    expect(data?.Q9Response).toBe(payload.answers[8].response)
    expect(data?.Q9InputMethods).toBe(payload.answers[8].inputMethods)
    expect(data?.Q9K).toBe(payload.answers[8].keystrokes)
    expect(data?.Q9Sco).toBe(payload.answers[8].score)
    expect(data?.Q9ResponseTime).toBe(payload.answers[8].responseTime)
    expect(data?.Q9TimeOut).toBe(Number(payload.answers[8].timeout))
    expect(data?.Q9TimeOutResponse).toBe(Number(payload.answers[8].timeoutResponse))
    expect(data?.Q9TimeOutSco).toBe(Number(payload.answers[8].timeoutScore))
    expect(data?.Q9tLoad?.toISOString()).toBe(payload.answers[8].loadTime?.toISOString())
    expect(data?.Q9tFirstKey?.toISOString()).toBe(payload.answers[8].firstKey?.toISOString())
    expect(data?.Q9tLastKey?.toISOString()).toBe(payload.answers[8].lastKey?.toISOString())
    expect(data?.Q9OverallTime).toBe(payload.answers[8].overallTime)
    expect(data?.Q9RecallTime).toBe(payload.answers[8].recallTime)
    expect(data?.Q9ReaderStart?.toISOString()).toBe(payload.answers[8].questionReaderStart?.toISOString())
    expect(data?.Q9ReaderEnd?.toISOString()).toBe(payload.answers[8].questionReaderEnd?.toISOString())

    expect(data?.Q10ID).toBe(payload.answers[9].id)
    expect(data?.Q10Response).toBe(payload.answers[9].response)
    expect(data?.Q10InputMethods).toBe(payload.answers[9].inputMethods)
    expect(data?.Q10K).toBe(payload.answers[9].keystrokes)
    expect(data?.Q10Sco).toBe(payload.answers[9].score)
    expect(data?.Q10ResponseTime).toBe(payload.answers[9].responseTime)
    expect(data?.Q10TimeOut).toBe(Number(payload.answers[9].timeout))
    expect(data?.Q10TimeOutResponse).toBe(Number(payload.answers[9].timeoutResponse))
    expect(data?.Q10TimeOutSco).toBe(Number(payload.answers[9].timeoutScore))
    expect(data?.Q10tLoad?.toISOString()).toBe(payload.answers[9].loadTime?.toISOString())
    expect(data?.Q10tFirstKey?.toISOString()).toBe(payload.answers[9].firstKey?.toISOString())
    expect(data?.Q10tLastKey?.toISOString()).toBe(payload.answers[9].lastKey?.toISOString())
    expect(data?.Q10OverallTime).toBe(payload.answers[9].overallTime)
    expect(data?.Q10RecallTime).toBe(payload.answers[9].recallTime)
    expect(data?.Q10ReaderStart?.toISOString()).toBe(payload.answers[9].questionReaderStart?.toISOString())
    expect(data?.Q10ReaderEnd?.toISOString()).toBe(payload.answers[9].questionReaderEnd?.toISOString())

    expect(data?.Q11ID).toBe(payload.answers[10].id)
    expect(data?.Q11Response).toBe(payload.answers[10].response)
    expect(data?.Q11InputMethods).toBe(payload.answers[10].inputMethods)
    expect(data?.Q11K).toBe(payload.answers[10].keystrokes)
    expect(data?.Q11Sco).toBe(payload.answers[10].score)
    expect(data?.Q11ResponseTime).toBe(payload.answers[10].responseTime)
    expect(data?.Q11TimeOut).toBe(Number(payload.answers[10].timeout))
    expect(data?.Q11TimeOutResponse).toBe(Number(payload.answers[10].timeoutResponse))
    expect(data?.Q11TimeOutSco).toBe(Number(payload.answers[10].timeoutScore))
    expect(data?.Q11tLoad?.toISOString()).toBe(payload.answers[10].loadTime?.toISOString())
    expect(data?.Q11tFirstKey?.toISOString()).toBe(payload.answers[10].firstKey?.toISOString())
    expect(data?.Q11tLastKey?.toISOString()).toBe(payload.answers[10].lastKey?.toISOString())
    expect(data?.Q11OverallTime).toBe(payload.answers[10].overallTime)
    expect(data?.Q11RecallTime).toBe(payload.answers[10].recallTime)
    expect(data?.Q11ReaderStart?.toISOString()).toBe(payload.answers[10].questionReaderStart?.toISOString())
    expect(data?.Q11ReaderEnd?.toISOString()).toBe(payload.answers[10].questionReaderEnd?.toISOString())

    expect(data?.Q12ID).toBe(payload.answers[11].id)
    expect(data?.Q12Response).toBe(payload.answers[11].response)
    expect(data?.Q12InputMethods).toBe(payload.answers[11].inputMethods)
    expect(data?.Q12K).toBe(payload.answers[11].keystrokes)
    expect(data?.Q12Sco).toBe(payload.answers[11].score)
    expect(data?.Q12ResponseTime).toBe(payload.answers[11].responseTime)
    expect(data?.Q12TimeOut).toBe(Number(payload.answers[11].timeout))
    expect(data?.Q12TimeOutResponse).toBe(Number(payload.answers[11].timeoutResponse))
    expect(data?.Q12TimeOutSco).toBe(Number(payload.answers[11].timeoutScore))
    expect(data?.Q12tLoad?.toISOString()).toBe(payload.answers[11].loadTime?.toISOString())
    expect(data?.Q12tFirstKey?.toISOString()).toBe(payload.answers[11].firstKey?.toISOString())
    expect(data?.Q12tLastKey?.toISOString()).toBe(payload.answers[11].lastKey?.toISOString())
    expect(data?.Q12OverallTime).toBe(payload.answers[11].overallTime)
    expect(data?.Q12RecallTime).toBe(payload.answers[11].recallTime)
    expect(data?.Q12ReaderStart?.toISOString()).toBe(payload.answers[11].questionReaderStart?.toISOString())
    expect(data?.Q12ReaderEnd?.toISOString()).toBe(payload.answers[11].questionReaderEnd?.toISOString())

    expect(data?.Q13ID).toBe(payload.answers[12].id)
    expect(data?.Q13Response).toBe(payload.answers[12].response)
    expect(data?.Q13InputMethods).toBe(payload.answers[12].inputMethods)
    expect(data?.Q13K).toBe(payload.answers[12].keystrokes)
    expect(data?.Q13Sco).toBe(payload.answers[12].score)
    expect(data?.Q13ResponseTime).toBe(payload.answers[12].responseTime)
    expect(data?.Q13TimeOut).toBe(Number(payload.answers[12].timeout))
    expect(data?.Q13TimeOutResponse).toBe(Number(payload.answers[12].timeoutResponse))
    expect(data?.Q13TimeOutSco).toBe(Number(payload.answers[12].timeoutScore))
    expect(data?.Q13tLoad?.toISOString()).toBe(payload.answers[12].loadTime?.toISOString())
    expect(data?.Q13tFirstKey?.toISOString()).toBe(payload.answers[12].firstKey?.toISOString())
    expect(data?.Q13tLastKey?.toISOString()).toBe(payload.answers[12].lastKey?.toISOString())
    expect(data?.Q13OverallTime).toBe(payload.answers[12].overallTime)
    expect(data?.Q13RecallTime).toBe(payload.answers[12].recallTime)
    expect(data?.Q13ReaderStart?.toISOString()).toBe(payload.answers[12].questionReaderStart?.toISOString())
    expect(data?.Q13ReaderEnd?.toISOString()).toBe(payload.answers[12].questionReaderEnd?.toISOString())

    expect(data?.Q14ID).toBe(payload.answers[13].id)
    expect(data?.Q14Response).toBe(payload.answers[13].response)
    expect(data?.Q14InputMethods).toBe(payload.answers[13].inputMethods)
    expect(data?.Q14K).toBe(payload.answers[13].keystrokes)
    expect(data?.Q14Sco).toBe(payload.answers[13].score)
    expect(data?.Q14ResponseTime).toBe(payload.answers[13].responseTime)
    expect(data?.Q14TimeOut).toBe(Number(payload.answers[13].timeout))
    expect(data?.Q14TimeOutResponse).toBe(Number(payload.answers[13].timeoutResponse))
    expect(data?.Q14TimeOutSco).toBe(Number(payload.answers[13].timeoutScore))
    expect(data?.Q14tLoad?.toISOString()).toBe(payload.answers[13].loadTime?.toISOString())
    expect(data?.Q14tFirstKey?.toISOString()).toBe(payload.answers[13].firstKey?.toISOString())
    expect(data?.Q14tLastKey?.toISOString()).toBe(payload.answers[13].lastKey?.toISOString())
    expect(data?.Q14OverallTime).toBe(payload.answers[13].overallTime)
    expect(data?.Q14RecallTime).toBe(payload.answers[13].recallTime)
    expect(data?.Q14ReaderStart?.toISOString()).toBe(payload.answers[13].questionReaderStart?.toISOString())
    expect(data?.Q14ReaderEnd?.toISOString()).toBe(payload.answers[13].questionReaderEnd?.toISOString())

    expect(data?.Q15ID).toBe(payload.answers[14].id)
    expect(data?.Q15Response).toBe(payload.answers[14].response)
    expect(data?.Q15InputMethods).toBe(payload.answers[14].inputMethods)
    expect(data?.Q15K).toBe(payload.answers[14].keystrokes)
    expect(data?.Q15Sco).toBe(payload.answers[14].score)
    expect(data?.Q15ResponseTime).toBe(payload.answers[14].responseTime)
    expect(data?.Q15TimeOut).toBe(Number(payload.answers[14].timeout))
    expect(data?.Q15TimeOutResponse).toBe(Number(payload.answers[14].timeoutResponse))
    expect(data?.Q15TimeOutSco).toBe(Number(payload.answers[14].timeoutScore))
    expect(data?.Q15tLoad?.toISOString()).toBe(payload.answers[14].loadTime?.toISOString())
    expect(data?.Q15tFirstKey?.toISOString()).toBe(payload.answers[14].firstKey?.toISOString())
    expect(data?.Q15tLastKey?.toISOString()).toBe(payload.answers[14].lastKey?.toISOString())
    expect(data?.Q15OverallTime).toBe(payload.answers[14].overallTime)
    expect(data?.Q15RecallTime).toBe(payload.answers[14].recallTime)
    expect(data?.Q15ReaderStart?.toISOString()).toBe(payload.answers[14].questionReaderStart?.toISOString())
    expect(data?.Q15ReaderEnd?.toISOString()).toBe(payload.answers[14].questionReaderEnd?.toISOString())

    expect(data?.Q16ID).toBe(payload.answers[15].id)
    expect(data?.Q16Response).toBe(payload.answers[15].response)
    expect(data?.Q16InputMethods).toBe(payload.answers[15].inputMethods)
    expect(data?.Q16K).toBe(payload.answers[15].keystrokes)
    expect(data?.Q16Sco).toBe(payload.answers[15].score)
    expect(data?.Q16ResponseTime).toBe(payload.answers[15].responseTime)
    expect(data?.Q16TimeOut).toBe(Number(payload.answers[15].timeout))
    expect(data?.Q16TimeOutResponse).toBe(Number(payload.answers[15].timeoutResponse))
    expect(data?.Q16TimeOutSco).toBe(Number(payload.answers[15].timeoutScore))
    expect(data?.Q16tLoad?.toISOString()).toBe(payload.answers[15].loadTime?.toISOString())
    expect(data?.Q16tFirstKey?.toISOString()).toBe(payload.answers[15].firstKey?.toISOString())
    expect(data?.Q16tLastKey?.toISOString()).toBe(payload.answers[15].lastKey?.toISOString())
    expect(data?.Q16OverallTime).toBe(payload.answers[15].overallTime)
    expect(data?.Q16RecallTime).toBe(payload.answers[15].recallTime)
    expect(data?.Q16ReaderStart?.toISOString()).toBe(payload.answers[15].questionReaderStart?.toISOString())
    expect(data?.Q16ReaderEnd?.toISOString()).toBe(payload.answers[15].questionReaderEnd?.toISOString())

    expect(data?.Q17ID).toBe(payload.answers[16].id)
    expect(data?.Q17Response).toBe(payload.answers[16].response)
    expect(data?.Q17InputMethods).toBe(payload.answers[16].inputMethods)
    expect(data?.Q17K).toBe(payload.answers[16].keystrokes)
    expect(data?.Q17Sco).toBe(payload.answers[16].score)
    expect(data?.Q17ResponseTime).toBe(payload.answers[16].responseTime)
    expect(data?.Q17TimeOut).toBe(Number(payload.answers[16].timeout))
    expect(data?.Q17TimeOutResponse).toBe(Number(payload.answers[16].timeoutResponse))
    expect(data?.Q17TimeOutSco).toBe(Number(payload.answers[16].timeoutScore))
    expect(data?.Q17tLoad?.toISOString()).toBe(payload.answers[16].loadTime?.toISOString())
    expect(data?.Q17tFirstKey?.toISOString()).toBe(payload.answers[16].firstKey?.toISOString())
    expect(data?.Q17tLastKey?.toISOString()).toBe(payload.answers[16].lastKey?.toISOString())
    expect(data?.Q17OverallTime).toBe(payload.answers[16].overallTime)
    expect(data?.Q17RecallTime).toBe(payload.answers[16].recallTime)
    expect(data?.Q17ReaderStart?.toISOString()).toBe(payload.answers[16].questionReaderStart?.toISOString())
    expect(data?.Q17ReaderEnd?.toISOString()).toBe(payload.answers[16].questionReaderEnd?.toISOString())

    expect(data?.Q18ID).toBe(payload.answers[17].id)
    expect(data?.Q18Response).toBe(payload.answers[17].response)
    expect(data?.Q18InputMethods).toBe(payload.answers[17].inputMethods)
    expect(data?.Q18K).toBe(payload.answers[17].keystrokes)
    expect(data?.Q18Sco).toBe(payload.answers[17].score)
    expect(data?.Q18ResponseTime).toBe(payload.answers[17].responseTime)
    expect(data?.Q18TimeOut).toBe(Number(payload.answers[17].timeout))
    expect(data?.Q18TimeOutResponse).toBe(Number(payload.answers[17].timeoutResponse))
    expect(data?.Q18TimeOutSco).toBe(Number(payload.answers[17].timeoutScore))
    expect(data?.Q18tLoad?.toISOString()).toBe(payload.answers[17].loadTime?.toISOString())
    expect(data?.Q18tFirstKey?.toISOString()).toBe(payload.answers[17].firstKey?.toISOString())
    expect(data?.Q18tLastKey?.toISOString()).toBe(payload.answers[17].lastKey?.toISOString())
    expect(data?.Q18OverallTime).toBe(payload.answers[17].overallTime)
    expect(data?.Q18RecallTime).toBe(payload.answers[17].recallTime)
    expect(data?.Q18ReaderStart?.toISOString()).toBe(payload.answers[17].questionReaderStart?.toISOString())
    expect(data?.Q18ReaderEnd?.toISOString()).toBe(payload.answers[17].questionReaderEnd?.toISOString())

    expect(data?.Q19ID).toBe(payload.answers[18].id)
    expect(data?.Q19Response).toBe(payload.answers[18].response)
    expect(data?.Q19InputMethods).toBe(payload.answers[18].inputMethods)
    expect(data?.Q19K).toBe(payload.answers[18].keystrokes)
    expect(data?.Q19Sco).toBe(payload.answers[18].score)
    expect(data?.Q19ResponseTime).toBe(payload.answers[18].responseTime)
    expect(data?.Q19TimeOut).toBe(Number(payload.answers[18].timeout))
    expect(data?.Q19TimeOutResponse).toBe(Number(payload.answers[18].timeoutResponse))
    expect(data?.Q19TimeOutSco).toBe(Number(payload.answers[18].timeoutScore))
    expect(data?.Q19tLoad?.toISOString()).toBe(payload.answers[18].loadTime?.toISOString())
    expect(data?.Q19tFirstKey?.toISOString()).toBe(payload.answers[18].firstKey?.toISOString())
    expect(data?.Q19tLastKey?.toISOString()).toBe(payload.answers[18].lastKey?.toISOString())
    expect(data?.Q19OverallTime).toBe(payload.answers[18].overallTime)
    expect(data?.Q19RecallTime).toBe(payload.answers[18].recallTime)
    expect(data?.Q19ReaderStart?.toISOString()).toBe(payload.answers[18].questionReaderStart?.toISOString())
    expect(data?.Q19ReaderEnd?.toISOString()).toBe(payload.answers[18].questionReaderEnd?.toISOString())

    expect(data?.Q20ID).toBe(payload.answers[19].id)
    expect(data?.Q20Response).toBe(payload.answers[19].response)
    expect(data?.Q20InputMethods).toBe(payload.answers[19].inputMethods)
    expect(data?.Q20K).toBe(payload.answers[19].keystrokes)
    expect(data?.Q20Sco).toBe(payload.answers[19].score)
    expect(data?.Q20ResponseTime).toBe(payload.answers[19].responseTime)
    expect(data?.Q20TimeOut).toBe(Number(payload.answers[19].timeout))
    expect(data?.Q20TimeOutResponse).toBe(Number(payload.answers[19].timeoutResponse))
    expect(data?.Q20TimeOutSco).toBe(Number(payload.answers[19].timeoutScore))
    expect(data?.Q20tLoad?.toISOString()).toBe(payload.answers[19].loadTime?.toISOString())
    expect(data?.Q20tFirstKey?.toISOString()).toBe(payload.answers[19].firstKey?.toISOString())
    expect(data?.Q20tLastKey?.toISOString()).toBe(payload.answers[19].lastKey?.toISOString())
    expect(data?.Q20OverallTime).toBe(payload.answers[19].overallTime)
    expect(data?.Q20RecallTime).toBe(payload.answers[19].recallTime)
    expect(data?.Q20ReaderStart?.toISOString()).toBe(payload.answers[19].questionReaderStart?.toISOString())
    expect(data?.Q20ReaderEnd?.toISOString()).toBe(payload.answers[19].questionReaderEnd?.toISOString())

    expect(data?.Q21ID).toBe(payload.answers[20].id)
    expect(data?.Q21Response).toBe(payload.answers[20].response)
    expect(data?.Q21InputMethods).toBe(payload.answers[20].inputMethods)
    expect(data?.Q21K).toBe(payload.answers[20].keystrokes)
    expect(data?.Q21Sco).toBe(payload.answers[20].score)
    expect(data?.Q21ResponseTime).toBe(payload.answers[20].responseTime)
    expect(data?.Q21TimeOut).toBe(Number(payload.answers[20].timeout))
    expect(data?.Q21TimeOutResponse).toBe(Number(payload.answers[20].timeoutResponse))
    expect(data?.Q21TimeOutSco).toBe(Number(payload.answers[20].timeoutScore))
    expect(data?.Q21tLoad?.toISOString()).toBe(payload.answers[20].loadTime?.toISOString())
    expect(data?.Q21tFirstKey?.toISOString()).toBe(payload.answers[20].firstKey?.toISOString())
    expect(data?.Q21tLastKey?.toISOString()).toBe(payload.answers[20].lastKey?.toISOString())
    expect(data?.Q21OverallTime).toBe(payload.answers[20].overallTime)
    expect(data?.Q21RecallTime).toBe(payload.answers[20].recallTime)
    expect(data?.Q21ReaderStart?.toISOString()).toBe(payload.answers[20].questionReaderStart?.toISOString())
    expect(data?.Q21ReaderEnd?.toISOString()).toBe(payload.answers[20].questionReaderEnd?.toISOString())

    expect(data?.Q22ID).toBe(payload.answers[21].id)
    expect(data?.Q22Response).toBe(payload.answers[21].response)
    expect(data?.Q22InputMethods).toBe(payload.answers[21].inputMethods)
    expect(data?.Q22K).toBe(payload.answers[21].keystrokes)
    expect(data?.Q22Sco).toBe(payload.answers[21].score)
    expect(data?.Q22ResponseTime).toBe(payload.answers[21].responseTime)
    expect(data?.Q22TimeOut).toBe(Number(payload.answers[21].timeout))
    expect(data?.Q22TimeOutResponse).toBe(Number(payload.answers[21].timeoutResponse))
    expect(data?.Q22TimeOutSco).toBe(Number(payload.answers[21].timeoutScore))
    expect(data?.Q22tLoad?.toISOString()).toBe(payload.answers[21].loadTime?.toISOString())
    expect(data?.Q22tFirstKey?.toISOString()).toBe(payload.answers[21].firstKey?.toISOString())
    expect(data?.Q22tLastKey?.toISOString()).toBe(payload.answers[21].lastKey?.toISOString())
    expect(data?.Q22OverallTime).toBe(payload.answers[21].overallTime)
    expect(data?.Q22RecallTime).toBe(payload.answers[21].recallTime)
    expect(data?.Q22ReaderStart?.toISOString()).toBe(payload.answers[21].questionReaderStart?.toISOString())
    expect(data?.Q22ReaderEnd?.toISOString()).toBe(payload.answers[21].questionReaderEnd?.toISOString())

    expect(data?.Q23ID).toBe(payload.answers[22].id)
    expect(data?.Q23Response).toBe(payload.answers[22].response)
    expect(data?.Q23InputMethods).toBe(payload.answers[22].inputMethods)
    expect(data?.Q23K).toBe(payload.answers[22].keystrokes)
    expect(data?.Q23Sco).toBe(payload.answers[22].score)
    expect(data?.Q23ResponseTime).toBe(payload.answers[22].responseTime)
    expect(data?.Q23TimeOut).toBe(Number(payload.answers[22].timeout))
    expect(data?.Q23TimeOutResponse).toBe(Number(payload.answers[22].timeoutResponse))
    expect(data?.Q23TimeOutSco).toBe(Number(payload.answers[22].timeoutScore))
    expect(data?.Q23tLoad?.toISOString()).toBe(payload.answers[22].loadTime?.toISOString())
    expect(data?.Q23tFirstKey?.toISOString()).toBe(payload.answers[22].firstKey?.toISOString())
    expect(data?.Q23tLastKey?.toISOString()).toBe(payload.answers[22].lastKey?.toISOString())
    expect(data?.Q23OverallTime).toBe(payload.answers[22].overallTime)
    expect(data?.Q23RecallTime).toBe(payload.answers[22].recallTime)
    expect(data?.Q23ReaderStart?.toISOString()).toBe(payload.answers[22].questionReaderStart?.toISOString())
    expect(data?.Q23ReaderEnd?.toISOString()).toBe(payload.answers[22].questionReaderEnd?.toISOString())

    expect(data?.Q24ID).toBe(payload.answers[23].id)
    expect(data?.Q24Response).toBe(payload.answers[23].response)
    expect(data?.Q24InputMethods).toBe(payload.answers[23].inputMethods)
    expect(data?.Q24K).toBe(payload.answers[23].keystrokes)
    expect(data?.Q24Sco).toBe(payload.answers[23].score)
    expect(data?.Q24ResponseTime).toBe(payload.answers[23].responseTime)
    expect(data?.Q24TimeOut).toBe(Number(payload.answers[23].timeout))
    expect(data?.Q24TimeOutResponse).toBe(Number(payload.answers[23].timeoutResponse))
    expect(data?.Q24TimeOutSco).toBe(Number(payload.answers[23].timeoutScore))
    expect(data?.Q24tLoad?.toISOString()).toBe(payload.answers[23].loadTime?.toISOString())
    expect(data?.Q24tFirstKey?.toISOString()).toBe(payload.answers[23].firstKey?.toISOString())
    expect(data?.Q24tLastKey?.toISOString()).toBe(payload.answers[23].lastKey?.toISOString())
    expect(data?.Q24OverallTime).toBe(payload.answers[23].overallTime)
    expect(data?.Q24RecallTime).toBe(payload.answers[23].recallTime)
    expect(data?.Q24ReaderStart?.toISOString()).toBe(payload.answers[23].questionReaderStart?.toISOString())
    expect(data?.Q24ReaderEnd?.toISOString()).toBe(payload.answers[23].questionReaderEnd?.toISOString())

    expect(data?.Q25ID).toBe(payload.answers[24].id)
    expect(data?.Q25Response).toBe(payload.answers[24].response)
    expect(data?.Q25InputMethods).toBe(payload.answers[24].inputMethods)
    expect(data?.Q25K).toBe(payload.answers[24].keystrokes)
    expect(data?.Q25Sco).toBe(payload.answers[24].score)
    expect(data?.Q25ResponseTime).toBe(payload.answers[24].responseTime)
    expect(data?.Q25TimeOut).toBe(Number(payload.answers[24].timeout))
    expect(data?.Q25TimeOutResponse).toBe(Number(payload.answers[24].timeoutResponse))
    expect(data?.Q25TimeOutSco).toBe(Number(payload.answers[24].timeoutScore))
    expect(data?.Q25tLoad?.toISOString()).toBe(payload.answers[24].loadTime?.toISOString())
    expect(data?.Q25tFirstKey?.toISOString()).toBe(payload.answers[24].firstKey?.toISOString())
    expect(data?.Q25tLastKey?.toISOString()).toBe(payload.answers[24].lastKey?.toISOString())
    expect(data?.Q25OverallTime).toBe(payload.answers[24].overallTime)
    expect(data?.Q25RecallTime).toBe(payload.answers[24].recallTime)
    expect(data?.Q25ReaderStart?.toISOString()).toBe(payload.answers[24].questionReaderStart?.toISOString())
    expect(data?.Q25ReaderEnd?.toISOString()).toBe(payload.answers[24].questionReaderEnd?.toISOString())
  })

  afterAll(async () => {
    await cleanUp()
    await sqlService.closePool()
  })
})
