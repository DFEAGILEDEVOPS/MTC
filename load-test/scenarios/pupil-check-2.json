{
  "config": {
    "target": "http://localhost:3001",
    "phases": [
      {
        "duration": 15,
        "arrivalRate": 5
      }
    ],
    "payload": {
      "path": "./data/pupilLogins.csv",
      "fields": [
        "schoolPin",
        "pupilPin"
      ]
    }
  },
  "scenarios": [
    {
      "name": "pupil login",
      "flow": [
        {
          "post": {
            "url": "/api/questions",
            "json": {
              "schoolPin": "{{ schoolPin }}",
              "pupilPin": "{{ pupilPin }}"
            },
            "capture": [
              {
                "json": "$.access_token",
                "as": "jwt"
              },
              {
                "json": "$.pupil.checkCode",
                "as": "checkCode"
              }
            ]
          }
        },
        {
          "think": 2
        },
        {
          "post": {
            "url": "/api/check-started",
            "json": {
              "accessToken": "{{ jwt }}",
              "checkCode": "{{ checkCode }}"
            }
          }
        },
        {
          "think": 5
        },
        {
          "post": {
            "url": "/api/completed-check",
            "json": {
              "access_token": "{{ jwt }}",
              "answers": [
                {
                  "factor1": 2,
                  "factor2": 5,
                  "answer": "6"
                },
                {
                  "factor1": 11,
                  "factor2": 2,
                  "answer": ""
                },
                {
                  "factor1": 5,
                  "factor2": 10,
                  "answer": ""
                }
              ],
              "audit": [
                {
                  "type": "PauseRendered",
                  "clientTimestamp": "2018-02-05T14:31:46.380Z"
                },
                {
                  "type": "QuestionRendered",
                  "clientTimestamp": "2018-02-05T14:31:49.160Z"
                }
              ],
              "config": {
                "questionTime": 5,
                "loadingTime": 2,
                "speechSynthesis": false
              },
              "inputs": [
                [
                  {
                    "input": "left click",
                    "eventType": "mousedown",
                    "clientInputDate": "2018-02-05T14:32:42.069Z",
                    "question": 1
                  },
                  {
                    "input": "6",
                    "eventType": "click",
                    "clientInputDate": "2018-02-05T14:32:42.075Z",
                    "question": 1
                  }
                ]
              ],
              "pupil": {
                "firstName": "Load",
                "lastName": "Test",
                "dob": "6 July 2008",
                "checkCode": "{{ checkCode }}"
              },
              "questions": [
                {
                  "order": 1,
                  "factor1": 2,
                  "factor2": 5
                },
                {
                  "order": 2,
                  "factor1": 11,
                  "factor2": 2
                }
              ],
              "school": {
                "id": 3,
                "name": "Load Test"
              }
            }
          }
        }
      ]
    }
  ]
}
