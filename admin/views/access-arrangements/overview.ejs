<%- partial('partials/_breadcrumbs_and_sign_out', { breadcrumbs }) %>
<div class="grid-row">
    <div class="column-two-thirds">
        <% if (messages && messages.info) { %>
        <div class="info-message clickable">
            <a href="#<%= highlight %>"><%= messages.info[0] %></a>
        </div>
        <% } %>
        <% if (messages && messages.deleteInfo) { %>
        <div class="info-message">
            <%= messages.deleteInfo[0] %>
        </div>
        <% } %>

        <%- partial('partials/_readonly', {availabilityData}) %>

        <header class="page-header">
            <h1 class="heading-xlarge">Access arrangements</h1>
        </header>
        <%- partial('partials/_session_expiry') %>
        <p class="lede">
          Modify the multiplication tables check for pupils with specific needs. The arrangements that are applied can be practised and configured by the pupils when the 'Try it out' area opens.
        </p>
    </div>
    <div class="column-one-third sidebar" aria-label="sidebar">
        <aside role="complementary" class="support-column">
            <h3 class="heading-medium">Related</h3>
            <nav role="navigation">
                <ul class="list">
                    <li>
                        <a href="<%- guidancePdf %>" target="_blank" rel="noopener noreferrer">Guidance</a>
                    </li>
                    <li>
                        <a href="/pupil-register/pupils-list">Pupil register</a>
                    </li>
                    <li>
                        <% if (pinGenerationEligibilityData.isFamiliarisationPinGenerationAllowed) { %>
                        <a href="/pupil-pin/generate-familiarisation-pins-overview">Try it out - password and PINs</a>
                        <% } %>
                    </li>
                    <li>
                        <% if (pinGenerationEligibilityData.isLivePinGenerationAllowed) { %>
                        <a href="/pupil-pin/generate-live-pins-overview">Start the MTC - password and PINs</a>
                        <% } %>
                    </li>
                </ul>
            </nav>
        </aside>
    </div>
</div>

<div class="grid-row">
    <div class="column-two-thirds">
        <form action="/access-arrangements/select-access-arrangements" name="select-pupils-and-arrangements">
            <div class="form-group">
                <div class="form-buttons">
                    <% if (!availabilityData.canEditArrangements) { %>
                    <input type="submit" class="button-secondary" value="Select pupil and arrangement" disabled/>
                    <% } else { %>
                    <input type="submit" class="button" value="Select pupil and arrangement"/>
                    <% } %>
                </div>
            </div>
        </form>
    </div>
    <div class="column-two-thirds">
        <%if (pupilsFormatted.length > 0) { %>
          <table id="submitted-pupil-access-arrangements" class="spacious">
            <thead>
            <tr>
              <th scope="col">Pupil</th>
              <th scope="col">Arrangement</th>
              <th scope="col"></th>
            </tr>
            </thead>
            <tbody>
            <% pupilsFormatted.forEach((p) => { %>
              <tr>
                <td class="
                <% if (p.urlSlug === highlight) { %> highlight-item <% } %>
                <% if (p.hasAAEditDisabled) { %> bold <% } %>
                ">
                  <div
                    id="<%= p.urlSlug %>"
                  <% if (p.verticalBarStyle) { %> class="highlight-wrapper"
                    style="<%= p.verticalBarStyle %>"
                    <% } %>
                  >
                    <% if (p.hasAAEditDisabled) { %>
                      <%= p.fullName %>
                    <% } else { %>
                      <a class="bold-small name-text-wrap"
                         href="/access-arrangements/select-access-arrangements/<%= p.urlSlug %>"><%= p.fullName %></a>
                    <% } %>
                    <% if (p.showDoB) { %>
                      <div class="font-greyed-out font-xsmall name-text-wrap">Date of birth: <%= p.dateOfBirth %></div>
                    <% } %>
                  </div>
                </td>
                <td class="access-arrangements-list">
                  <% p.arrangements && p.arrangements.forEach((pupilAccessArrangement) => { %>
                    <div><%= pupilAccessArrangement %></div>
                  <% }) %>
                </td>
                <td>
                  <% if(p.hasCompletedCheck) { %>
                    Completed Check
                  <% } else if(p.notTakingCheck) { %>
                    Not taking check
                  <% } else if (availabilityData.canEditArrangements) { %>
                    <a id="access-arrangements-remove-link" class="modal-link font-small" id="js-modal-link" href="/access-arrangements/delete-access-arrangements/<%= p.urlSlug %>">Remove</a>
                  <% } %>
                </td>
              </tr>
            <% }) %>
            </tbody>
          </table>
    <% } else { %>
        No pupils with access arrangements or modifications selected.
        <% } %>
    </div>
</div>
<%- partial('partials/_modal_box', {
    modalTitle: 'Remove arrangements',
    modalText: 'Are you sure you want to remove all access arrangements for this pupil?',
    modalConfirmationLabel: 'Yes',
    modalConfirmationUrl: '#',
    modalCancelLabel: 'No',
    modalCancelUrl: '#'
}) %>

<div class="back-to-top-container">
    <a href="#top">Back to top</a>
</div>
