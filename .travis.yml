sudo: required

language: nodejs

node_js:
  - 8.4.0

addons:
  chrome: stable

services:
  - docker

before_install:
  - rvm install 2.4.0
  - docker-compose --version
  - docker-compose build
  - docker-compose start


install:
  - cd ${TRAVIS_BUILD_DIR}/admin/test && gem install bundler && bundle install
  - cd ${TRAVIS_BUILD_DIR}/pupil-spa/test && gem install bundler && bundle install

script:
  - if [[ "$TEST_TYPE" = admin-specs ]]; then cd ${TRAVIS_BUILD_DIR}/admin && npm test; fi
  - if [[ "$TEST_TYPE" = pupil-specs ]]; then cd ${TRAVIS_BUILD_DIR}/pupil-spa && npm run test-single; fi
  - if [[ "$TEST_TYPE" = admin-e2e ]]; then cd ${TRAVIS_BUILD_DIR}/admin && ./test.sh; fi
  - if [[ "$TEST_TYPE" = pupil-e2e ]]; then cd ${TRAVIS_BUILD_DIR}/pupil-spa && ./test.sh; fi
